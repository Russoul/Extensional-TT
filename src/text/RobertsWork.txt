//Lemma #0
Lemma0 : A → ¬¬A
Lemma0 x α = α x

//Lemma #1
Lemma1 : ¬¬¬A → ¬A
Lemma1 (α : ¬¬A → ⊥) x = α (Lemma0 x)

//Weak classicality
IsClassical : 𝕌 → 𝕌
IsClassical A = ¬¬A → A

¬-is-classical : IsClassical (¬A)
¬-is-classical = Lemma1

⨯-is-classical : IsClassical A → IsClassical B → IsClassical (A ⨯ B)
⨯-is-classical p q (c : ¬¬(A ⨯ B)) = (p ((x : ¬A) ↦ c ((a, b) ↦ x a : ¬(A ⨯ B))), q ((y : ¬B) ↦ c ((a, b) ↦ y b : ¬(A ⨯ B))))

→-is-classical : IsClassical B → IsClassical (A → B)
→-is-classical α (f : ((A → B) → ⊥) → ⊥) (a : A) = α ((nb : ¬B) ↦ f ((h : A → B) ↦ nb (h a)))

Π-is-classical : ((x : A) → IsClassical (B x)) → IsClassical (Π A B)
Π-is-classical α (f : ¬¬(Π A B)) x = α x ((ny : ¬(B x)) ↦ f ((h : Π A B) ↦ ny (h x)))

Nor A B ≔ ¬A ⨯ ¬B


Or A B ≔ ¬(Nor A B)

Nand A B ≔ ¬(Nor (¬A) (¬B))

And A B ≔ ¬(Nand A B)

_∧_ = And

_∨_ = Or

¬-over-∧ : IsClassical A => IsClassical B => ¬(A ∧ B) → (¬A ∨ ¬B)
¬-over-∧ α =
∎
  //¬(A ∧ B) is isomorphic to ¬(A ⨯ B)
  //but so is the goal ∎


Lemma2 : IsClassical (Nor A B)
∎
//By definition it's enough to show
IsClassical (¬A ⨯ ¬B)
//By ⨯-is-classical
It's enough to show
IsClassical ¬A and IsClassical ¬B
But both are as ¬X is classical for every X ∎


// Or A ¬A = ¬(Nor A ¬A) = ¬(¬A ⨯ ¬¬A)

IsClassical (Or A B) = IsClassical (¬ (Nor A B)) ✔

LEM : IsClassical A => A ∨ (¬A)
∎
// By definition of _∨_ it's enough to show
¬(Nor A (¬A))
// By definition it's enough to show
¬(¬A ⨯ ¬¬A)
//By classicality of A it's enough to show
¬(¬A ⨯ A)
//By definition of ¬
((A → ⊥) ⨯ A) → ⊥
//Curry
(A → ⊥) → (A → ⊥)
//Identity ∎

//Classical forall
∀(x : A) B ≔ (x : A) → ¬¬(B x)

Σ-is-classical : IsClassical A → ((x : A) → IsClassical (B x)) → ¬¬(Σ A B) → Σ A B
Σ-is-classical p q α = (p ((na : ¬A) ↦ α ((h : Σ A B) ↦ na h.π₁)), q _ ((nb : ¬ (B (p ((na : ¬A) ↦ α ((h : Σ A B) ↦ na h.π₁))))) ↦ α ((h : Σ A B) ↦ nb)))
h.π₂ : B h.π₁





----------------------------------

//Strong classicality
IsClassical : 𝕌 → 𝕌
IsClassical A = ¬¬A ≅ A

Lemma : IsClassical A → IsProp A
∎
//It's enough to show that
//given
x y : A
//we can derive
? : x ≡ y
//Let's denote Aᶜ : A → ¬¬A
//We have
Aᶜ x : ¬¬A
Aᶜ y : ¬¬A
//But ¬¬A is a mere proposition hence
Aᶜ x = Aᶜ y
//Strong classicality gives us an inverse of Aᶜ:
//Aᶜ⁻¹ : ¬¬A → A
Aᶜ⁻¹ (Aᶜ x) = Aᶜ⁻¹ (Aᶜ y)
//It's an inverse:
x = y ∎


(x : A) ⊦ B type
α : (x : A) → IsClassical B
-----------------------------
(∀ (x : A) B) ≅ (Π (x : A) B)
∎
(∀ (x : A) B)
=
(Π (x : A) ¬¬B)
≅ //By fiberwise classicality of B
(Π (x : A) B) ∎
